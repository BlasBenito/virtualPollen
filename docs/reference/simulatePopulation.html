<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulates population dynamics for virtual species with different traits. — simulatePopulation • virtualPollen</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Simulates population dynamics for virtual species with different traits. — simulatePopulation" />

<meta property="og:description" content="This function takes as input a dataframe of parameters defining virtual taxa produced by parametersDataframe and fixParametersTypes, a driver or drivers generated with simulateDriver or simulateDriverS, and simulates population dynamics for the given virtual taxa at yearly resolution for the time-length defined by the driver or drivers. Important: note that the variable time runs from left to right, with lower values representing older samples. The model relies on the following set of assumptions:

The spatial structure of the population is not important to explain its pollen productivity. This is an operative assumption, to speed-up model execution.
The environmental niche of the species follows a Gaussian distribution, characterized by a mean (niche optimum, also niche position) and a standard deviation (niche breadth or tolerance).
Different drivers can have a different influence on the species dynamics, and that influence can be defined by the user by tuning the weights of each driver.
Environmental suitability, expressed in the range [0, 1], is the result of an additive function of the species niches (normal function defined by the species' mean and standard deviation for each driver), the drivers' values, and the relative influence of each driver (driver weights).
Pollen productivity is a function of the individual's biomass and environmental suitability, so under a hypothetical constant individual's biomass, its pollen production depends linearly on environmental suitability values.
Effective fecundity is limited by environmental suitability. Low environmental suitability values limit recruitment, acting as an environmental filter. Therefore, even though the fecundity of the individuals is fixed by the fecundity parameter, the overall population fecundity is limited by environmental suitability.
" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">virtualPollen</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/using_virtualPollen.html">virtualPollen</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/BlasBenito/virtualPollen">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulates population dynamics for virtual species with different traits.</h1>
    <small class="dont-index">Source: <a href='https://github.com/BlasBenito/virtualPollen/blob/master/R/simulatePopulation.R'><code>R/simulatePopulation.R</code></a></small>
    <div class="hidden name"><code>simulatePopulation.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function takes as input a dataframe of parameters defining virtual taxa produced by <code><a href='parametersDataframe.html'>parametersDataframe</a></code> and <code><a href='fixParametersTypes.html'>fixParametersTypes</a></code>, a driver or drivers generated with <code><a href='simulateDriver.html'>simulateDriver</a></code> or <code><a href='simulateDriverS.html'>simulateDriverS</a></code>, and simulates population dynamics for the given virtual taxa at yearly resolution for the time-length defined by the driver or drivers. <strong>Important</strong>: note that the variable <code>time</code> runs from left to right, with lower values representing older samples. The model relies on the following set of assumptions:</p>
<ul>
<li><p>The spatial structure of the population is not important to explain its pollen productivity. This is an operative assumption, to speed-up model execution.</p></li>
<li><p>The environmental niche of the species follows a Gaussian distribution, characterized by a mean (niche optimum, also niche position) and a standard deviation (niche breadth or tolerance).</p></li>
<li><p>Different drivers can have a different influence on the species dynamics, and that influence can be defined by the user by tuning the weights of each driver.</p></li>
<li><p>Environmental suitability, expressed in the range [0, 1], is the result of an additive function of the species niches (normal function defined by the species' mean and standard deviation for each driver), the drivers' values, and the relative influence of each driver (driver weights).</p></li>
<li><p>Pollen productivity is a function of the individual's biomass and environmental suitability, so under a hypothetical constant individual's biomass, its pollen production depends linearly on environmental suitability values.</p></li>
<li><p>Effective fecundity is limited by environmental suitability. Low environmental suitability values limit recruitment, acting as an environmental filter. Therefore, even though the fecundity of the individuals is fixed by the fecundity parameter, the overall population fecundity is limited by environmental suitability.</p></li>
</ul>
    
    </div>

    <pre class="usage"><span class='fu'>simulatePopulation</span>(
  <span class='kw'>parameters</span><span class='kw'>=</span><span class='kw'>NULL</span>,
  <span class='kw'>species</span><span class='kw'>=</span><span class='st'>"all"</span>,
  <span class='kw'>driver.A</span><span class='kw'>=</span><span class='kw'>NULL</span>,
  <span class='kw'>driver.B</span><span class='kw'>=</span><span class='kw'>NULL</span>,
  <span class='kw'>drivers</span><span class='kw'>=</span><span class='kw'>NULL</span>,
  <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>TRUE</span>
  )</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>parameters</th>
      <td><p>dataframe with parameters.</p></td>
    </tr>
    <tr>
      <th>species</th>
      <td><p>if "all" or "ALL", all species in "parameters" are simulated It also accepts a vector of numbers representing the rows of the selected species, or a vector of names of the selected species.</p></td>
    </tr>
    <tr>
      <th>driver.A</th>
      <td><p>numeric vector with driver values. Typically produced by <code><a href='simulateDriver.html'>simulateDriver</a></code>.</p></td>
    </tr>
    <tr>
      <th>driver.B</th>
      <td><p>numeric vector with driver values.  Typically produced by <code><a href='simulateDriver.html'>simulateDriver</a></code>. Must have same length as <code>driver.A</code>.</p></td>
    </tr>
    <tr>
      <th>drivers</th>
      <td><p>dataframe with drivers produced by <code><a href='simulateDriverS.html'>simulateDriverS</a></code>. It should have the columns:</p><ul>
<li><p><em>time</em> integer.</p></li>
<li><p><em>driver</em> character, values are <code>A</code> and <code>B</code></p></li>
<li><p><em>autocorrelation.length</em> numeric, values are 200, 600, and 1800.</p></li>
<li><p><em>value</em> numeric, value of the driver for the given <em>time</em>.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>boolean, generates a warming-up period for the population model of a length of five times the maximum age of the virtual taxa.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of dataframes, each one of them with the results of one simulation. The dataset <code><a href='simulation.html'>simulation</a></code> exemplifies the output of this function. Each dataframe in the output list has the columns:</p><ul>
<li><p><em>Time</em> integer, ages in years. Negative ages indicate the burn-in period.</p></li>
<li><p><em>Pollen</em> numeric, pollen counts</p></li>
<li><p><em>Population.mature</em> numeric, number of mature individuals.</p></li>
<li><p><em>Population.immatre</em> numeric, number of immature individuals.</p></li>
<li><p><em>Population.viable.seeds</em> numeric, number of viable seeds generated each year.</p></li>
<li><p><em>Suitability</em> numeric, environmental suitability computed from the driver by the normal function/s defining the taxon niche.</p></li>
<li><p><em>Biomass.total</em> numeric, overall biomass of the population.</p></li>
<li><p><em>Biomass.mature</em> numeric, sum of biomass of mature individuals.</p></li>
<li><p><em>Biomass.immature</em> numeric, sum of biomass of immature individuals.</p></li>
<li><p><em>Mortality.mature</em> numeric, number of mature individuals dead each year.</p></li>
<li><p><em>Mortality.immature</em> numeric, same as above for immature individuals.</p></li>
<li><p><em>Driver.A</em> numeric, values of driver A.</p></li>
<li><p><em>Driver.B</em> numeric, values of driver B, if available, and NA otherwise.</p></li>
<li><p><em>Period</em> qualitative, with value "Burn-in" for burn-in period, and "Simulation" otherwise.</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The model starts with a population of 100 individuals with random ages, in the range [1, maximum age], taken from a uniform distribution (all ages are equiprobable). For each environmental suitability value, including the burn-in period, the model performs the following operations:</p>
<ul>
<li><p><strong>Aging</strong>: adds one year to the age of the individuals.</p></li>
<li><p><strong>Mortality due to senescence</strong>: individuals reaching the maximum age are removed from the simulation.</p></li>
<li><p><strong>Local extinction and immigration</strong>: If the number of individuals drops to zero, the population is replaced by a "seed bank" of #' 100 individuals with age zero, and the simulation jumps to step 7.. This is intended to simulate the arrival of seeds from nearby regions, and will only lead to population growth if environmental suitability is higher than zero.</p></li>
<li><p><strong>Plant growth</strong>: Applies a plant growth equation to compute the biomass of every individual.</p></li>
<li><p><strong>Carrying capacity</strong>: If maximum population biomass is reached, individuals are iteratively selected for removal according to a mortality risk curve computed by the equation \(P_{m} = 1 - sqrt(a/A)\), were <em>Pm</em> is the probability of mortality, <em>a</em> is the age of the given individual, and <em>A</em> is the maximum age reached by the virtual taxa. This curve gives removal preference to younger individuals, matching observed patterns in natural populations.</p></li>
<li><p><strong>Pollen productivity</strong>: In each time step the model computes the pollen productivity (in relative values) of the population using the equation \(P_{t} = \sum x_{it} \times max(S_{t}, B)\), where <em>t</em> is time (a given simulation time step), <em>P</em> is the pollen productivity of the population at a given time, <em>x_i</em> represents the biomass of every adult individual, <em>S</em> is the environmental suitability at the given time, <em>B</em> is the contribution of biomass to pollen productivity regardless of environmental suitability (<em>pollen.control</em> parameter in the simulation, 0 by default). If <em>B</em> equals 1, <em>P</em> is equal to the total biomass sum of the adult population, regardless of the environmental suitability. If <em>B</em> equals 0, pollen productivity depends entirely on environmental suitability values.</p></li>
<li><p><strong>Reproduction</strong>: Generates as many seeds as reproductive individuals are available multiplied by the maximum fecundity and the environmental suitability of the given time.</p></li>
</ul><p>The model returns a table with climatic suitability, pollen production, and population size (reproductive individuals only) per simulation year. Figure 10 shows the results of the population model when applied to the example virtual species.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='parametersDataframe.html'>parametersDataframe</a></code>, <code><a href='fixParametersTypes.html'>fixParametersTypes</a></code>, <code><a href='plotSimulation.html'>plotSimulation</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>#getting data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>parameters</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>driverA</span>)

<span class='co'>#simulating population dynamics</span>
<span class='co'># of first taxon in parameters</span>
<span class='co'># for first 500 values of driverA</span>
<span class='no'>sim.output</span> <span class='kw'>&lt;-</span> <span class='fu'>simulatePopulation</span>(
 <span class='kw'>parameters</span><span class='kw'>=</span><span class='no'>parameters</span>[<span class='fl'>1</span>,],
 <span class='kw'>driver.A</span><span class='kw'>=</span><span class='no'>driverA</span>[<span class='fl'>1</span>:<span class='fl'>500</span>]
 )</div><div class='output co'>#&gt; <span class='message'>Simulating taxon: S10A50-5_f10</span></div><div class='input'>
<span class='co'>#checking output</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/str'>str</a></span>(<span class='no'>sim.output</span>)</div><div class='output co'>#&gt; List of 1
#&gt;  $ S10A50-5_f10:'data.frame':	600 obs. of  14 variables:
#&gt;   ..$ Time                   : int [1:600] -100 -99 -98 -97 -96 -95 -94 -93 -92 -91 ...
#&gt;   ..$ Pollen                 : num [1:600] 4794 5289 4548 2876 2790 ...
#&gt;   ..$ Population.mature      : num [1:600] 49 54 46 29 28 48 54 48 45 49 ...
#&gt;   ..$ Population.immature    : num [1:600] 34 498 482 336 231 245 301 341 294 276 ...
#&gt;   ..$ Population.viable.seeds: num [1:600] 479 528 454 287 278 462 524 471 439 480 ...
#&gt;   ..$ Suitability            : num [1:600] 0.995 0.998 1 1 1 ...
#&gt;   ..$ Biomass.total          : num [1:600] 6539 8387 9988 9982 9986 ...
#&gt;   ..$ Biomass.mature         : num [1:600] 4819 5302 4548 2876 2790 ...
#&gt;   ..$ Biomass.immature       : num [1:600] 1719 3085 5441 7106 7197 ...
#&gt;   ..$ Mortality.mature       : num [1:600] 0 0 11 9 2 19 21 18 15 15 ...
#&gt;   ..$ Mortality.immature     : num [1:600] 0 0 535 597 391 217 373 466 503 437 ...
#&gt;   ..$ Driver.A               : num [1:600] NA NA NA NA NA NA NA NA NA NA ...
#&gt;   ..$ Driver.B               : logi [1:600] NA NA NA NA NA NA ...
#&gt;   ..$ Period                 : Factor w/ 2 levels "Burn-in","Simulation": 1 1 1 1 1 1 1 1 1 1 ...</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Blas M. Benito  &lt;blasbenito@gmail.com&gt;</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Blas M. Benito.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

