<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulating Pollen Curves from Virtual Taxa with Different Life and Niche Traits â€¢ virtualPollen</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Simulating Pollen Curves from Virtual Taxa with Different Life and Niche Traits">
<meta property="og:description" content="Tools to generate virtual environmental drivers with a given temporal autocorrelation, and to simulate pollen curves at annual resolution over millennial time-scales based on these drivers and virtual taxa with different life traits and niche features. It also provides the means to simulate quasi-realistic pollen-data conditions by applying simulated accumulation rates and given depth intervals between consecutive samples.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">virtualPollen</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/using_virtualPollen.html">virtualPollen</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BlasBenito/virtualPollen">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="virtualpollen" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#virtualpollen" class="anchor"></a>virtualPollen</h1></div>
<p>The goal of virtualPollen is to provide the tools to simulate pollen curves over millenial time-scales generated by virtual taxa with different life traits (life-span, fecundity, growth-rate) and niche features (niche position and breadth) as a response to virtual environmental drivers with a given temporal autocorrelation. It furthers allow to simulate specific data properties of fossil pollen datasets, such as sediment accumulation rate, and depth intervals between consecutive pollen samples. The simulation outcomes are useful to better understand the role of plant traits, niche properties, and climatic variability in defining the shape of pollen curves.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of virtualPollen from <a href="https://github.com/BlasBenito/virtualPollen">GitHub</a> or soon from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#from GitHub</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(devtools)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"blasbenito/virtualPollen"</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#from CRAN (not yet)</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"virtualPollen"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(virtualPollen)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(viridis)</a></code></pre></div>
</div>
<div id="workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#workflow" class="anchor"></a>Workflow</h2>
<p>The basic workflow consists of the following steps:</p>
<p><strong>1.</strong> <strong>Generate virtual drivers</strong> with <em>simulateDriverS</em>. The user can define a random seed, a time vector, length of the autocorrelation structure of the driver, minimum and maximum values, and names of the drivers. Note that the final length of the temporal autocorrelation is only approximate, and that <strong>time</strong> runs from left to right, meaning that older samples have lower time values.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">#generating two drivers with different autocorrelation lengths</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">myDrivers &lt;-<span class="st"> </span><span class="kw"><a href="reference/simulateDriverS.html">simulateDriverS</a></span>(</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"> <span class="dt">random.seeds=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">60</span>, <span class="dv">120</span>),</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"> <span class="dt">time=</span><span class="dv">1</span><span class="op">:</span><span class="dv">5000</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"> <span class="dt">autocorrelation.lengths=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">200</span>, <span class="dv">600</span>),</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"> <span class="dt">output.min=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"> <span class="dt">output.max=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>, <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"> <span class="dt">driver.names=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"> <span class="dt">filename=</span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#checking output</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(myDrivers)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; 'data.frame':    20000 obs. of  4 variables:</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt;  $ time                  : int  1 2 3 4 5 6 7 8 9 10 ...</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;  $ driver                : chr  "A" "A" "A" "A" ...</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;  $ autocorrelation.length: num  200 200 200 200 200 200 200 200 200 200 ...</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;  $ value                 : num  79.3 82.4 79.3 77.4 80.7 ...</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#note that individual drivers can be created</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#with the function simulateDriver as well</span></a></code></pre></div>
<p><strong>2.</strong> <strong>Define the traits of the virtual taxa</strong>. Note that the dataframe with the parameters can be either filled with numeric vectors, or manually, by using the function <a href="https://CRAN.R-project.org/package=editData">editData</a>. Please, check the help of the function <em>parametersDataframe</em> and the vignette to better understand the meaning of the traits.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">#generating template of the dataframe</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">myParameters &lt;-<span class="st"> </span><span class="kw"><a href="reference/parametersDataframe.html">parametersDataframe</a></span>(<span class="dt">rows=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#checking columns in parameters</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(myParameters)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 'data.frame':    2 obs. of  16 variables:</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;  $ label                   : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;  $ maximum.age             : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;  $ reproductive.age        : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt;  $ fecundity               : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;  $ growth.rate             : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;  $ pollen.control          : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;  $ maximum.biomass         : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt;  $ carrying.capacity       : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;  $ driver.A.weight         : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;  $ driver.B.weight         : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;  $ niche.A.mean            : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt;  $ niche.A.sd              : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt;  $ niche.B.mean            : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt;  $ niche.B.sd              : logi  NA NA</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt;  $ autocorrelation.length.A: logi  NA NA</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt;  $ autocorrelation.length.B: logi  NA NA</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#filling it with vectors</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25">myParameters[<span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Species 1"</span>, <span class="dv">50</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">2000</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">75</span>, <span class="dv">10</span>, <span class="dv">75</span>, <span class="dv">15</span>, <span class="dv">200</span>, <span class="dv">600</span>)</a>
<a class="sourceLine" id="cb5-26" data-line-number="26">myParameters[<span class="dv">2</span>,] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Species 2"</span>, <span class="dv">1000</span>, <span class="dv">60</span>, <span class="dv">2</span>, <span class="fl">0.05</span>, <span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">2000</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">50</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">15</span>, <span class="dv">200</span>, <span class="dv">600</span>)</a>
<a class="sourceLine" id="cb5-27" data-line-number="27"></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="co">#fixing column types</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29">myParameters &lt;-<span class="st"> </span><span class="kw"><a href="reference/fixParametersTypes.html">fixParametersTypes</a></span>(<span class="dt">x =</span> myParameters)</a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="co">#&gt; Checking taxon Species 1</span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="co">#&gt; Checking taxon Species 2</span></a>
<a class="sourceLine" id="cb5-32" data-line-number="32"></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="co">#visualizing main parameters</span></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="kw"><a href="reference/parametersCheck.html">parametersCheck</a></span>(<span class="dt">parameters =</span> myParameters, </a>
<a class="sourceLine" id="cb5-35" data-line-number="35">                <span class="dt">species =</span> <span class="st">"all"</span>,</a>
<a class="sourceLine" id="cb5-36" data-line-number="36">                <span class="dt">drivers =</span> myDrivers)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<p><strong>3.</strong> <strong>Simulate population dynamics and pollen productivity</strong> of the virtual taxa.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">#simulating population dynamics</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">mySimulation &lt;-<span class="st"> </span><span class="kw"><a href="reference/simulatePopulation.html">simulatePopulation</a></span>(<span class="dt">parameters =</span> myParameters,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                                   <span class="dt">species =</span> <span class="st">"all"</span>,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                                   <span class="dt">drivers =</span> myDrivers)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; Simulating taxon: Species 1</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; Simulating taxon: Species 2</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#mySimulation is a list with two dataframes</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#let's look at the first one</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">mySimulation.df &lt;-<span class="st"> </span>mySimulation[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(mySimulation.df)</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; 'data.frame':    5500 obs. of  14 variables:</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt;  $ Time                   : int  -500 -499 -498 -497 -496 -495 -494 -493 -492 -491 ...</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt;  $ Pollen                 : num  2000 1784 1684 1400 1300 ...</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;  $ Population.mature      : num  20 18 17 14 13 9 7 5 5 4 ...</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt;  $ Population.immature    : num  0 124 147 251 218 285 248 212 163 143 ...</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt;  $ Population.viable.seeds: num  199 178 168 139 129 89 69 49 49 39 ...</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt;  $ Suitability            : num  1 0.991 0.991 1 1 ...</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt;  $ Biomass.total          : num  2000 2000 1998 1998 1994 ...</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt;  $ Biomass.mature         : num  2000 1800 1700 1400 1300 ...</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt;  $ Biomass.immature       : num  0 200 298 598 694 ...</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt;  $ Mortality.mature       : num  56 0 1 0 0 1 1 0 0 1 ...</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt;  $ Mortality.immature     : num  20 75 155 64 172 62 126 105 98 69 ...</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt;  $ Driver.A               : num  NA NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt;  $ Driver.B               : num  NA NA NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt;  $ Period                 : Factor w/ 2 levels "Burn-in","Simulation": 1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#note that "Time" has negative values</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#they define a burn-in period used</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#to warm-up the simulation.</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#can be removed with:</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31">mySimulation.df &lt;-<span class="st"> </span>mySimulation.df[mySimulation.df<span class="op">$</span>Time <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, ]</a>
<a class="sourceLine" id="cb6-32" data-line-number="32"></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#plotting the simulation</span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="kw"><a href="reference/plotSimulation.html">plotSimulation</a></span>(<span class="dt">simulation.output =</span> mySimulation,</a>
<a class="sourceLine" id="cb6-36" data-line-number="36">               <span class="dt">line.size =</span> <span class="fl">0.4</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"><img src="reference/figures/README-unnamed-chunk-5-2.png" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#comparing pollen curves for a given time</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="reference/compareSimulations.html">compareSimulations</a></span>(<span class="dt">simulation.output =</span> mySimulation,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                   <span class="dt">species =</span> <span class="st">"all"</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">                   <span class="dt">columns =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Suitability"</span>, <span class="st">"Pollen"</span>),</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">                   <span class="dt">time.zoom =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2000</span>, <span class="dv">3000</span>),</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">                   <span class="dt">text.size =</span> <span class="dv">14</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<p><strong>4.</strong> <strong>Generate a virtual accumulation rate</strong>. Note that virtual accumulation rates generated by the function <em>simulateAccumulationRate</em> are not intended to be realistic (similar to existing accumulation rate curves), but to provide the means to distort the pollen data in similar ways as real accumulation rate curves do. Still, the users can use their own accumulation rates, as long as they have the same estructure as the output of <em>simulateAccumulationRate</em>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#simulationg accumulation rate</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">myAccumulationRate &lt;-<span class="st"> </span><span class="kw"><a href="reference/simulateAccumulationRate.html">simulateAccumulationRate</a></span>(</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"> <span class="dt">seed =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"> <span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5000</span>,</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"> <span class="dt">output.min =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"> <span class="dt">output.max =</span> <span class="dv">40</span>,</a>
<a class="sourceLine" id="cb8-8" data-line-number="8"> <span class="dt">direction =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb8-9" data-line-number="9"> <span class="dt">plot =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"> )</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#checking the output</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(myAccumulationRate)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; 'data.frame':    5000 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;  $ time             : int  1 2 3 4 5 6 7 8 9 10 ...</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt;  $ accumulation.rate: num  40 39 39 39 39 39 39 39 39 39 ...</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt;  $ grouping         : num  1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#all samples in mySimulation with the same grouping variable</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#are to be aggregated into the same centimeter (in the next step)</span></a></code></pre></div>
<p><strong>5.</strong> Apply the <strong>virtual accumulation rate</strong> to the simulation, and sample the outcome at different <strong>depth intervals</strong>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">#applying accumulation rate and</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#sampling at: every cm, 2 cm and 3 cm between samples</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">mySimulation.aggregated &lt;-<span class="st"> </span><span class="kw"><a href="reference/aggregateSimulation.html">aggregateSimulation</a></span>(</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="dt">simulation.output =</span> mySimulation,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  <span class="dt">accumulation.rate =</span> myAccumulationRate,</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  <span class="dt">sampling.intervals =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#the output is a matrix-like list</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#rows are simulated taxa</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#first column is the original data</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#second column is the data aggregated by the accumulation rate</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#rest of columns represent sampling intervals</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#comparing data of the first row</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mySimulation.aggregated[[<span class="dv">1</span>,<span class="dv">1</span>]]<span class="op">$</span>Time, </a>
<a class="sourceLine" id="cb10-17" data-line-number="17">     mySimulation.aggregated[[<span class="dv">1</span>,<span class="dv">1</span>]]<span class="op">$</span>Pollen,</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">     <span class="dt">type =</span> <span class="st">"l"</span>, </a>
<a class="sourceLine" id="cb10-19" data-line-number="19">     <span class="dt">xlim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</a>
<a class="sourceLine" id="cb10-20" data-line-number="20">     <span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">1200</span>),</a>
<a class="sourceLine" id="cb10-21" data-line-number="21">     <span class="dt">ylab =</span> <span class="st">"Pollen"</span>,</a>
<a class="sourceLine" id="cb10-22" data-line-number="22">     <span class="dt">xlab =</span> <span class="st">"Time (years)"</span>,</a>
<a class="sourceLine" id="cb10-23" data-line-number="23">     <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">4</span>)[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(mySimulation.aggregated[[<span class="dv">1</span>,<span class="dv">2</span>]]<span class="op">$</span>Time, </a>
<a class="sourceLine" id="cb10-25" data-line-number="25">     mySimulation.aggregated[[<span class="dv">1</span>,<span class="dv">2</span>]]<span class="op">$</span>Pollen,</a>
<a class="sourceLine" id="cb10-26" data-line-number="26">     <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">4</span>)[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(mySimulation.aggregated[[<span class="dv">1</span>,<span class="dv">3</span>]]<span class="op">$</span>Time, </a>
<a class="sourceLine" id="cb10-28" data-line-number="28">     mySimulation.aggregated[[<span class="dv">1</span>,<span class="dv">3</span>]]<span class="op">$</span>Pollen,</a>
<a class="sourceLine" id="cb10-29" data-line-number="29">     <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">4</span>)[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(mySimulation.aggregated[[<span class="dv">1</span>,<span class="dv">4</span>]]<span class="op">$</span>Time, </a>
<a class="sourceLine" id="cb10-31" data-line-number="31">     mySimulation.aggregated[[<span class="dv">1</span>,<span class="dv">4</span>]]<span class="op">$</span>Pollen,</a>
<a class="sourceLine" id="cb10-32" data-line-number="32">     <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">4</span>)[<span class="dv">1</span>])</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<p><strong>6.</strong> Optional: <strong>re-interpolate the data into a regular time grid</strong>. Comparing the different pollen curves through methods such as regression requires them to be in the same temporal grid (a.k.a, have the same number of cases). The function <em>toRegularTime</em> handles that seamlessly.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">#interpolating at 50 years resolution.</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">mySimulation.regular &lt;-<span class="st"> </span><span class="kw"><a href="reference/toRegularTime.html">toRegularTime</a></span>(</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="dt">x =</span> mySimulation.aggregated,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="dt">time.column =</span> <span class="st">"Time"</span>,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="dt">interpolation.interval =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="dt">columns.to.interpolate =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Suitability"</span>, <span class="st">"Pollen"</span>)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; Warning in sqrt(sum.squares/one.delta): NaNs produced</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; Warning in sqrt(sum.squares/one.delta): NaNs produced</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; Warning in sqrt(sum.squares/one.delta): NaNs produced</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; Warning in sqrt(sum.squares/one.delta): NaNs produced</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; Warning in sqrt(sum.squares/one.delta): NaNs produced</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#&gt; Warning in sqrt(sum.squares/one.delta): NaNs produced</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">#&gt; Warning in sqrt(sum.squares/one.delta): NaNs produced</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">#comparing interpolated data</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mySimulation.regular[[<span class="dv">1</span>,<span class="dv">1</span>]]<span class="op">$</span>Time, </a>
<a class="sourceLine" id="cb11-24" data-line-number="24">     mySimulation.regular[[<span class="dv">1</span>,<span class="dv">1</span>]]<span class="op">$</span>Pollen,</a>
<a class="sourceLine" id="cb11-25" data-line-number="25">     <span class="dt">type =</span> <span class="st">"l"</span>, </a>
<a class="sourceLine" id="cb11-26" data-line-number="26">     <span class="dt">xlim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</a>
<a class="sourceLine" id="cb11-27" data-line-number="27">     <span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">1200</span>),</a>
<a class="sourceLine" id="cb11-28" data-line-number="28">     <span class="dt">ylab =</span> <span class="st">"Pollen"</span>,</a>
<a class="sourceLine" id="cb11-29" data-line-number="29">     <span class="dt">xlab =</span> <span class="st">"Time (years)"</span>,</a>
<a class="sourceLine" id="cb11-30" data-line-number="30">     <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">4</span>)[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="co">#note that this function modifies the original dataset!</span></a>
<a class="sourceLine" id="cb11-32" data-line-number="32"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(mySimulation.regular[[<span class="dv">1</span>,<span class="dv">2</span>]]<span class="op">$</span>Time, </a>
<a class="sourceLine" id="cb11-33" data-line-number="33">     mySimulation.regular[[<span class="dv">1</span>,<span class="dv">2</span>]]<span class="op">$</span>Pollen,</a>
<a class="sourceLine" id="cb11-34" data-line-number="34">     <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">4</span>)[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb11-35" data-line-number="35"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(mySimulation.regular[[<span class="dv">1</span>,<span class="dv">3</span>]]<span class="op">$</span>Time, </a>
<a class="sourceLine" id="cb11-36" data-line-number="36">     mySimulation.regular[[<span class="dv">1</span>,<span class="dv">3</span>]]<span class="op">$</span>Pollen,</a>
<a class="sourceLine" id="cb11-37" data-line-number="37">     <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">4</span>)[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb11-38" data-line-number="38"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(mySimulation.regular[[<span class="dv">1</span>,<span class="dv">4</span>]]<span class="op">$</span>Time, </a>
<a class="sourceLine" id="cb11-39" data-line-number="39">     mySimulation.regular[[<span class="dv">1</span>,<span class="dv">4</span>]]<span class="op">$</span>Pollen,</a>
<a class="sourceLine" id="cb11-40" data-line-number="40">     <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/reexports">viridis</a></span>(<span class="dv">4</span>)[<span class="dv">1</span>])</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/BlasBenito/virtualPollen">https://â€‹github.com/â€‹BlasBenito/â€‹virtualPollen</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing virtualPollen</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Blas M. Benito <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Blas M. Benito.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
